<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>ZBL - ZBL&#x27;s Doodle</title>
    <meta name="description" content="Don&#x27;t be a dabbler" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <!-- <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" /> -->

    <meta name="generator" content="Ghost ?" />
<link rel="alternate" type="application/rss+xml" title="ZBL&#39;s Doodle" href="/rss/index.xml">
<link rel="canonical" href="http://zhangbinliu.me/oops-devops.html" />
</head>
<body class="author-template author-ZBL post-template nav-closed">

    

    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
    </nav>
</header>

<main class="content" role="main">
    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Oops...DevOps</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-10-21">21 October 2016</time> 
            </section>
        </header>

        <section class="post-content">
            <h1 id="oops-devops">Oops...DevOps</h1>
<p><img src="/content/images/2016/10/13696947_266466680392407_1036551811_n-1.jpg" alt=""></p>
<p>æ™šä¸ŠèŠ±æ—¶é—´æ¥æ¸…ç†é‚®ç®±ï¼ŒæŸ¥æ”¶åˆ°äº† DNSPod å‘æ¥çš„ä¸€å †ç›‘æ§è­¦å‘Šé‚®ä»¶ï¼Œæ‰çªç„¶å‘ç°è‡ªå·±é•¿è‰å¤šå¹´çš„åšå®¢å·²ç»å®•æœºåŠä¸ªæœˆä¹‹ä½™ï¼<br>
è¿…é€Ÿæ‰“å¼€åšå®¢åœ°å€ï¼Œå¤§å†™çš„ <strong>502 Bad Gateway</strong> ä¸ Nginx æ›´é…å™¢ã€‚ç°åœ¨å°±æ˜¯æœ‰å°å¼ºåŠ›é™¤è‰æœºä¹Ÿæ²¡ç”¨äº†ã€‚<br>
äºæˆ‘è¿˜ä¸€ç›´æŒ‰æ—¶ç»™ DO å……å€¼æ‰“é’±...</p>
<p>äºæ˜¯ç«‹é©¬ <code>mosh</code> åˆ°å¤§æ´‹å½¼å²¸çš„ VPSï¼ˆè¿™é‡Œè¿˜ç›´æ¥ç”¨çš„è”é€šæµé‡ï¼‰ï¼Œ <code>service ghost restart &amp;&amp; service nginx restart</code> ä¹‹åï¼Œ502 ä»ç„¶ç»§ç»­ã€‚</p>
<p>ç»§ç»­æƒ³èµ·åŠä¸ªæœˆå‰æ‰‹è´±å‡çº§äº†ç³»ç»Ÿ Node ç‰ˆæœ¬ã€‚
<code>node -v</code> åå‘ç°å·²ç»æ˜¯ <code>v6.3.x</code> äº†ï¼Œè€Œ Ghost ç°åœ¨<a href="http://support.ghost.org/supported-node-versions/">å®˜æ–¹æ”¯æŒç‰ˆæœ¬</a>é‡Œå¹¶æ²¡æœ‰ <code>v6.x</code>ï¼Œå¯èƒ½å°±æ˜¯ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ã€‚</p>
<p>é€šè¿‡ DO å®˜æ–¹ <a href="https://www.digitalocean.com/community/questions/how-to-upgrade-node-js-on-older-ghost-droplets">Node å‡çº§æŒ‡å—</a>ï¼Œè£…å¥½åè™½ç„¶ <code>/usr/bin/node -v</code> è¿”å›æ˜¯ <code>v4.x</code> ï¼Œä½† <code>which node</code> åŠ <code>/usr/local/bin/node -v</code> è¿”å›ä»ç„¶ä¸º <code>6.x</code>ã€‚é‚£å°±æŒ‡å—æš´åŠ›è¦†ç›–äº†ï¼ <code>rm /usr/local/bin/npm &amp;&amp; cp /usr/bin/node /usr/local/bin/node</code>ï¼Œ ä¸€ç•ªæ›´æ–°ä¿®æ”¹åï¼Œ<code>system node</code> ç‰ˆæœ¬æˆåŠŸ downgrade ä¸º <code>v4.x</code>ã€‚</p>
<p>é«˜å…´åœ°æ•²å‡» <code>npm start --production</code>ï¼Œç»“æœå‘ç°åé¢æ›´å¤šçš„å‘éœ€è¦å¡«...</p>
<p><code>npm start --production</code> åï¼Œç›´æ¥æ‰”å‡ºäº†ä¸€ä¸ª <code>Node Error Stack</code> å¦‚ä¸‹ï¼š</p>
<pre class="hljs"><code>Unhandled rejection Error: Cannot find module &#39;<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\sqlite</span>3<span class="hljs-command">\lib</span><span class="hljs-command">\binding</span><span class="hljs-command">\node</span>-v44-linux-x64<span class="hljs-command">\node</span>_sqlite3.node&#39;
    at Function.Module._resolveFilename (module.js:336:15)
    at Function.Module._load (module.js:286:25)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Object.&lt;anonymous&gt; (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\sqlite</span>3<span class="hljs-command">\lib</span><span class="hljs-command">\sqlite</span>3.js:4:15)
    at Module._compile (module.js:430:26)
    at Object.Module._extensions..js (module.js:448:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Client_SQLite3.initDriver (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\knex</span><span class="hljs-command">\lib</span><span class="hljs-command">\dialects</span><span class="hljs-command">\sqlite</span>3<span class="hljs-command">\index</span>.js:41:24)
    at new Client_SQLite3 (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\knex</span><span class="hljs-command">\lib</span><span class="hljs-command">\dialects</span><span class="hljs-command">\sqlite</span>3<span class="hljs-command">\index</span>.js:15:10)
    at Knex.initialize (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\knex</span><span class="hljs-command">\knex</span>.js:109:15)
    at Knex (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\knex</span><span class="hljs-command">\knex</span>.js:13:26)
    at ConfigManager.set (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\core</span><span class="hljs-command">\server</span><span class="hljs-command">\config</span><span class="hljs-command">\index</span>.js:153:24)
    at ConfigManager.init (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\core</span><span class="hljs-command">\server</span><span class="hljs-command">\config</span><span class="hljs-command">\index</span>.js:76:10)
    at <span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\core</span><span class="hljs-command">\server</span><span class="hljs-command">\config</span><span class="hljs-command">\index</span>.js:267:30
    at tryCatcher (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\util</span>.js:24:31)
    at Promise._settlePromiseFromHandler (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\promise</span>.js:454:31)
    at Promise._settlePromiseAt (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\promise</span>.js:530:18)
    at Promise._settlePromises (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\promise</span>.js:646:14)
    at Async._drainQueue (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\async</span>.js:177:16)
    at Async._drainQueues (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\async</span>.js:187:10)
    at Immediate.Async.drainQueues <span class="hljs-special">[</span>as _onImmediate<span class="hljs-special">]</span> (<span class="hljs-special">[</span>REDACTED<span class="hljs-special">]</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\ghost</span><span class="hljs-command">\node</span>_modules<span class="hljs-command">\bluebird</span><span class="hljs-command">\js</span><span class="hljs-command">\main</span><span class="hljs-command">\async</span>.js:15:14)
    at processImmediate <span class="hljs-special">[</span>as _immediateCallback<span class="hljs-special">]</span> (timers.js:371:17)</code></pre><p>ï¼ˆè¿™é‡Œä¹Ÿå¯ä»¥ <code>tail -n 100 /var/log/ghost/error.log</code> æŸ¥çœ‹æŠ›å‡ºçš„é”™è¯¯æ ˆã€‚ï¼‰</p>
<p>å””ï¼Œä»”ç»†çœ‹äº†ä¸‹ï¼Œå¯èƒ½æ˜¯ npm åŒ…æ²¡æœ‰å®Œæ•´è£…å¥½ï¼Œæˆ–è€… npm åŒ…çš„ç‰ˆæœ¬ä¸å…¼å®¹å§ã€‚
æ„Ÿè°¢ Googleï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª<a href="https://github.com/TryGhost/Ghost/issues/5911">ç±»ä¼¼çš„ issue</a>ï¼Œæ¥¼é‡Œæ°å¥½æœ‰ä¸€ä½é­é‡åŒæ ·æƒ…å†µçš„å°å“¥ï¼Œæœºæ™ºåœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>Ghost supports node version 4.2.0 also. I was having this error &quot;ERROR: Cannot find module &#39;../../node_modules/sqlite3/lib/binding/node-v46-linux-x64/node_sqlite3.node&#39; &quot; .</p>
<p>I just installed node version 4.2.0 using nvm and installed sqlite3. The &quot;binding&quot; folder inside sqlite3 got a node-v47 folder instead of v46. So I just renamed the folder to v46 and downloaded the node_sqlite3.node file from here <a href="http://www.unifieddigital.com/node_modules/sqlite3/lib/binding/node-v46-linux-x64/">http://www.unifieddigital.com/node_modules/sqlite3/lib/binding/node-v46-linux-x64/</a>.</p>
<p>THIS WORKED FOR ME.!!!</p>
</blockquote>
<p>ç®€ç›´äº†ï¼Œæˆ‘çœŸæ˜¯æ„Ÿè°¢ä»–ï¼Œ<strong>THIS ALSO WORKED FOR ME!!!</strong></p>
<p>ç»ˆäº <code>npm start --production</code> å¯ä»¥æˆåŠŸè·‘èµ·æ¥ ğŸ˜† ~ <br>
<code>Ctrl-c</code> åï¼Œ<code>service ghost restart</code>ï¼Œåˆ·æ–° Blogï¼Œå•Šå“ˆå“ˆï¼ŒWelcome to Ghost ~</p>
<p>æ‰€ä»¥<del>æ„‰å¿«æµç•…åœ°</del>å‡çº§åˆ°äº† Ghost <code>v0.11.2</code> ...<br>
ï¼ˆå®˜æ–¹ä¹Ÿæœ‰ä¸€ä»½å…³äº <code>SQLite3 Error</code> <a href="http://support.ghost.org/troubleshooting/#sqlite3-errors">TroubleShooting</a></p>
<p>ä½†æ˜¯æ³¨æ„ï¼Œ<strong>å¤‡ä»½</strong>çš„é‡è¦æ€§æ¥äº†ï¼</p>
<p>è¿™é‡Œç²—æš´å‡çº§åï¼Œç›¸å½“äºæ˜¯æ–°è£…çš„ Ghostï¼Œæ‰“å¼€ <code>{hostname}/ghost</code>ï¼Œä¼šéœ€è¦ä½ é‡æ–°æ³¨å†Œä¸€ä¸ªç”¨æˆ·è´¦å·ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªæ³¨å†Œçš„è´¦å·ï¼Œä¼šé»˜è®¤ä½œä¸º Ghost <code>Owner</code>ã€‚ä½†æ˜¯è¿™é‡Œä»€ä¹ˆæ•°æ®éƒ½æ²¡æœ‰ã€‚æ‰“å¼€ <code>ghost/data/</code> æˆ–è€… <code>ghost/content/theme/</code> åº”è¯¥éƒ½æ˜¯åªæœ‰ç³»ç»Ÿé»˜è®¤æ•°æ®ï¼Œè€Œä¹‹å‰çš„é‚£äº›ç”¨æˆ·æ•°æ®éƒ½æ²¡æœ‰äº†ã€‚</p>
<p>è¿˜å¥½æˆ‘åœ¨ä¹‹å‰å°±æœ‰æƒ³åˆ°è‡ªå·±æœ‰å¯èƒ½è¿™ä¹ˆç²—æš´å‡çº§ Ghostï¼Œæœ¬åœ°å·²ç»æœ‰äº†ä¸€ä»½ <code>.json</code> åç¼€çš„ exported dataã€‚äºæ˜¯åœ¨åå° <code>Settings -&gt; Labs</code>ï¼Œç‚¹å‡» <code>import data</code>ï¼ŒæˆåŠŸåˆ·æ–°åï¼Œä¹‹å‰æ‰€æœ‰å¤‡ä»½è¿‡çš„åšå®¢æ–‡ç« æ•°æ®éƒ½æ¢å¤å•¦ï¼å°½ç®¡æˆ‘å¹¶ä¸æ˜¯ä»€ä¹ˆé«˜äº§åšä¸»ï¼Œä½†æ˜¯ä¸¤å¹´å‰æ‰å…¥é—¨å‰ç«¯æ—¶ï¼ŒèŠ±å¿ƒæ€å†™çš„ä¸€äº›ä¸œè¥¿è¯´æ²¡å°±æ²¡ä¹Ÿæ˜¯ä¸€ç§é—æ†¾ã€‚æ‰€ä»¥çœŸæ˜¯è´´å¿ƒçš„å°åŠŸèƒ½ã€‚ï¼ˆä¸è¿‡è¿™é‡Œçš„æ•°æ®å¤‡ä»½åªåŒ…æ‹¬ Post æ•°æ®ï¼Œä¸åŒ…æ‹¬ Theme / User Avatar ç­‰ï¼Œæ‰€ä»¥ä»ç„¶éœ€è¦ <code>cp -r myTheme/ theme/</code>ï¼Œæˆ–è€…åœ¨åå° Settings -&gt; General ä¸Šä¼ ä¸»é¢˜å›¾ç‰‡å’Œç”¨æˆ·å¤´åƒã€‚ï¼‰</p>
<p>æå®šåï¼Œä¸€åˆ‡éƒ½æ¢å¤äº†æ—¥å¸¸ã€‚<br>
å®•æœºè¿™ä¹ˆä¹…ï¼ŒDevOps è„–å­å¥½ç–¼ã€‚<br>
å””ï¼Œå†³å®šæ¯å¤©éƒ½æ‹¿ç€å¼ºåŠ›é™¤è‰æœºæ¥åˆ·ä¸€åˆ·ï¼Œè®©è¿™é‡Œæˆä¸ºè‡ªå·±çš„ä¸€å°ç‰‡ <code>Playground</code>ã€‚</p>
<p>å¾ˆä¹…ä¹‹å‰è¯»è¿‡ä¸€å¥è¯ï¼Œå¤§æ¦‚æ„æ€æ˜¯ï¼Œä¸ºä»€ä¹ˆåœ¨å„ç§å…è´¹åšå®¢å¹³å°ç››è¡Œçš„æ—¶å€™ï¼Œä½ è¿˜è¦è‡ªå·±å»è´­ä¹°åŸŸåè´­ä¹°æœåŠ¡å™¨ç„¶åæ­å»ºä¸€å¥—åšå®¢å¹³å°å‘¢ï¼Ÿåªå› ä¸ºï¼Œè¿™æ ·å†™å‡ºæ¥çš„ä¸œè¥¿ï¼Œå°±æ°¸è¿œæ‰“ä¸Šäº†è‡ªå·±çš„åŸŸåé‚£æ ·ç‰¹æœ‰çš„çƒ™å°ã€‚<br>
å…¸å‹çš„ä¸ªäººé£æ ¼æ–‡å­—ï¼Œç‰¹ç«‹ç‹¬è¡Œçš„æ€æƒ³ã€‚
å¸Œæœ›æˆ‘èƒ½æ‹¥æœ‰ã€‚</p>
<p><img src="/content/images/2016/10/13768177_295401884143837_1899942111_n.jpg" alt="from Instagram"></p>

            <section itemprop="comment" class="post-comments">
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_config = function () {
                    this.page.url = 'http://zhangbinliu.me/oops-devops.html';
                    this.page.identifier = '6';
                  };
                var disqus_shortname = 'zblsdoodle';
                (function() { // DON'T EDIT BELOW THIS LINE
                  var d = document, s = d.createElement('script');
                  s.async = true;
                  s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  s.setAttribute('data-timestamp', +new Date());
                  (d.head || d.body).appendChild(s);
                })();
            </script>
            </section>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="/author/ZBL/" style="background-image: url(/content/images/avatar_zbl.jpg)"><span class="hidden">ZBL's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="/author/ZBL/">ZBL</a></h4>

                    <p>Don&#x27;t be a dabbler</p>
                <div class="author-meta">
                    <span class="author-location icon-location"> </span>
                    <span class="author-link icon-link"><a href="http://zhangbinliu.me/author/zbl">http://zhangbinliu.me/author/zbl</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Oops...DevOps&amp;url=http://zhangbinliu.me/oops-devops.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://zhangbinliu.me/oops-devops.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://zhangbinliu.me/oops-devops.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

    </article>
</main>

<aside class="read-next">
</aside>




        <footer class="site-footer clearfix">
            <section class="copyright"><a href="http://zhangbinliu.me">ZBL&#x27;s Doodle</a> &copy; 2016</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
